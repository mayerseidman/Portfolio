{"ast":null,"code":"\"use strict\";\n\nfunction _interopRequireDefault(e) {\n  return e && e.__esModule ? e : {\n    default: e\n  };\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n});\n\nvar _defineProperty2 = require(\"babel-runtime/helpers/defineProperty\"),\n    _defineProperty3 = _interopRequireDefault(_defineProperty2),\n    _typeof2 = require(\"babel-runtime/helpers/typeof\"),\n    _typeof3 = _interopRequireDefault(_typeof2),\n    _extends3 = require(\"babel-runtime/helpers/extends\"),\n    _extends4 = _interopRequireDefault(_extends3),\n    _getPrototypeOf = require(\"babel-runtime/core-js/object/get-prototype-of\"),\n    _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf),\n    _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\"),\n    _classCallCheck3 = _interopRequireDefault(_classCallCheck2),\n    _createClass2 = require(\"babel-runtime/helpers/createClass\"),\n    _createClass3 = _interopRequireDefault(_createClass2),\n    _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\"),\n    _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2),\n    _inherits2 = require(\"babel-runtime/helpers/inherits\"),\n    _inherits3 = _interopRequireDefault(_inherits2),\n    _react = require(\"react\"),\n    _react2 = _interopRequireDefault(_react),\n    _propTypes = require(\"prop-types\"),\n    _globals = require(\"./globals\"),\n    _throttle = require(\"./throttle\"),\n    _throttle2 = _interopRequireDefault(_throttle),\n    inOut = (0, _propTypes.shape)({\n  make: _propTypes.func,\n  duration: _propTypes.number.isRequired,\n  delay: _propTypes.number.isRequired,\n  forever: _propTypes.bool,\n  count: _propTypes.number.isRequired,\n  style: _propTypes.object.isRequired,\n  reverse: _propTypes.bool\n}),\n    propTypes = {\n  collapse: _propTypes.bool,\n  collapseEl: _propTypes.element,\n  cascade: _propTypes.bool,\n  wait: _propTypes.number,\n  force: _propTypes.bool,\n  disabled: _propTypes.bool,\n  appear: _propTypes.bool,\n  enter: _propTypes.bool,\n  exit: _propTypes.bool,\n  fraction: _propTypes.number,\n  refProp: _propTypes.string,\n  innerRef: _propTypes.func,\n  onReveal: _propTypes.func,\n  unmountOnExit: _propTypes.bool,\n  mountOnEnter: _propTypes.bool,\n  inEffect: inOut.isRequired,\n  outEffect: (0, _propTypes.oneOfType)([inOut, (0, _propTypes.oneOf)([!1])]).isRequired,\n  alwaysReveal: _propTypes.bool,\n  collapseOnly: _propTypes.bool,\n  ssrFadeout: _propTypes.bool\n},\n    defaultProps = {\n  fraction: .2,\n  refProp: \"ref\"\n},\n    contextTypes = {\n  transitionGroup: _propTypes.object\n},\n    RevealBase = function (e) {\n  function t(e, i) {\n    (0, _classCallCheck3.default)(this, t);\n    var s = (0, _possibleConstructorReturn3.default)(this, (t.__proto__ || (0, _getPrototypeOf2.default)(t)).call(this, e, i));\n    s.isOn = !(\"when\" in e) || !!e.when, s.state = {\n      collapse: e.collapse ? t.getInitialCollapseStyle(e) : void 0,\n      style: {\n        opacity: s.isOn && !e.alwaysReveal || !e.outEffect ? void 0 : 0\n      }\n    }, s.savedChild = !1, s.isListener = !1, s.isShown = !1, s.ticking = !1;\n\n    var o = function () {\n      s.reveal(), s.ticking = !1;\n    },\n        n = function () {\n      s.ticking || ((0, _globals.raf)(o), s.ticking = !0);\n    };\n\n    return s.revealHandler = n, s.resizeHandler = (0, _throttle2.default)(s.resize.bind(s), 500), s.saveRef = s.saveRef.bind(s), s;\n  }\n\n  return (0, _inherits3.default)(t, e), (0, _createClass3.default)(t, [{\n    key: \"saveRef\",\n    value: function (e) {\n      this.childRef && this.childRef(e), this.props.innerRef && this.props.innerRef(e), this.el = e && \"offsetHeight\" in e ? e : void 0;\n    }\n  }, {\n    key: \"inViewport\",\n    value: function () {\n      if (!this.el || window.document.hidden) return !1;\n      var e = this.el.offsetHeight,\n          i = window.pageYOffset - t.getTop(this.el),\n          s = Math.min(e, window.innerHeight) * (_globals.globalHide ? this.props.fraction : 0);\n      return i > s - window.innerHeight && i < e - s;\n    }\n  }, {\n    key: \"resize\",\n    value: function () {\n      this && this.el && this.isOn && this.inViewport() && (this.unlisten(), this.isShown = this.isOn, this.setState({\n        hasExited: !this.isOn,\n        hasAppeared: !0,\n        collapse: void 0,\n        style: {\n          opacity: this.isOn || !this.props.outEffect ? 1 : 0\n        }\n      }), this.onReveal(this.props));\n    }\n  }, {\n    key: \"invisible\",\n    value: function () {\n      this && this.el && (this.savedChild = !1, this.isShown || (this.setState({\n        hasExited: !0,\n        style: (0, _extends4.default)({}, this.state.style, {\n          visibility: \"hidden\"\n        })\n      }), this.props.collapse && window.document.dispatchEvent(_globals.collapseend)));\n    }\n  }, {\n    key: \"animationEnd\",\n    value: function (e, t, i) {\n      var s = this,\n          o = i.forever,\n          n = i.count,\n          a = i.delay,\n          r = i.duration;\n\n      if (!o) {\n        var l = function () {\n          s && s.el && (s.animationEndTimeout = void 0, e.call(s));\n        };\n\n        this.animationEndTimeout = window.setTimeout(l, a + (r + (t ? r : 0) * n));\n      }\n    }\n  }, {\n    key: \"getDimensionValue\",\n    value: function () {\n      return this.el.offsetHeight + parseInt(window.getComputedStyle(this.el, null).getPropertyValue(\"margin-top\"), 10) + parseInt(window.getComputedStyle(this.el, null).getPropertyValue(\"margin-bottom\"), 10);\n    }\n  }, {\n    key: \"collapse\",\n    value: function (e, t, i) {\n      var s = i.duration + (t.cascade ? i.duration : 0),\n          o = this.isOn ? this.getDimensionValue() : 0,\n          n = void 0,\n          a = void 0;\n      if (t.collapseOnly) n = i.duration / 3, a = i.delay;else {\n        var r = s >> 2,\n            l = r >> 1;\n        n = r, a = i.delay + (this.isOn ? 0 : s - r - l), e.style.animationDuration = s - r + (this.isOn ? l : -l) + \"ms\", e.style.animationDelay = i.delay + (this.isOn ? r - l : 0) + \"ms\";\n      }\n      return e.collapse = {\n        height: o,\n        transition: \"height \" + n + \"ms ease \" + a + \"ms\",\n        overflow: t.collapseOnly ? \"hidden\" : void 0\n      }, e;\n    }\n  }, {\n    key: \"animate\",\n    value: function (e) {\n      if (this && this.el && (this.unlisten(), this.isShown !== this.isOn)) {\n        this.isShown = this.isOn;\n        var t = !this.isOn && e.outEffect,\n            i = e[t ? \"outEffect\" : \"inEffect\"],\n            s = \"style\" in i && i.style.animationName || void 0,\n            o = void 0;\n        e.collapseOnly ? o = {\n          hasAppeared: !0,\n          hasExited: !1,\n          style: {\n            opacity: 1\n          }\n        } : ((e.outEffect || this.isOn) && i.make && (s = i.make), o = {\n          hasAppeared: !0,\n          hasExited: !1,\n          collapse: void 0,\n          style: (0, _extends4.default)({}, i.style, {\n            animationDuration: i.duration + \"ms\",\n            animationDelay: i.delay + \"ms\",\n            animationIterationCount: i.forever ? \"infinite\" : i.count,\n            opacity: 1,\n            animationName: s\n          }),\n          className: i.className\n        }), this.setState(e.collapse ? this.collapse(o, e, i) : o), t ? (this.savedChild = _react2.default.cloneElement(this.getChild()), this.animationEnd(this.invisible, e.cascade, i)) : this.savedChild = !1, this.onReveal(e);\n      }\n    }\n  }, {\n    key: \"onReveal\",\n    value: function (e) {\n      e.onReveal && this.isOn && (this.onRevealTimeout && (this.onRevealTimeout = window.clearTimeout(this.onRevealTimeout)), e.wait ? this.onRevealTimeout = window.setTimeout(e.onReveal, e.wait) : e.onReveal());\n    }\n  }, {\n    key: \"unlisten\",\n    value: function () {\n      this.isListener && (window.removeEventListener(\"scroll\", this.revealHandler, {\n        passive: !0\n      }), window.removeEventListener(\"orientationchange\", this.revealHandler), window.document.removeEventListener(\"visibilitychange\", this.revealHandler), window.document.removeEventListener(\"collapseend\", this.revealHandler), window.removeEventListener(\"resize\", this.resizeHandler), this.isListener = !1), this.onRevealTimeout && (this.onRevealTimeout = window.clearTimeout(this.onRevealTimeout)), this.animationEndTimeout && (this.animationEndTimeout = window.clearTimeout(this.animationEndTimeout));\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function () {\n      this.unlisten(), _globals.ssr && (0, _globals.disableSsr)();\n    }\n  }, {\n    key: \"listen\",\n    value: function () {\n      this.isListener || (this.isListener = !0, window.addEventListener(\"scroll\", this.revealHandler, {\n        passive: !0\n      }), window.addEventListener(\"orientationchange\", this.revealHandler), window.document.addEventListener(\"visibilitychange\", this.revealHandler), window.document.addEventListener(\"collapseend\", this.revealHandler), window.addEventListener(\"resize\", this.resizeHandler));\n    }\n  }, {\n    key: \"reveal\",\n    value: function (e) {\n      var t = this;\n      this && this.el && (e || (e = this.props), _globals.ssr && (0, _globals.disableSsr)(), this.isOn && this.isShown && \"spy\" in e ? (this.isShown = !1, this.setState({\n        style: {}\n      }), window.setTimeout(function () {\n        return t.reveal(e);\n      }, 200)) : this.inViewport() ? this.animate(e) : this.listen());\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function () {\n      if (this.el && !this.props.disabled) {\n        this.props.collapseOnly || (\"make\" in this.props.inEffect && this.props.inEffect.make(!1, this.props), \"when\" in this.props && this.props.outEffect && \"make\" in this.props.outEffect && this.props.outEffect.make(!0, this.props));\n        var e = this.context.transitionGroup,\n            i = e && !e.isMounting ? !(\"enter\" in this.props && !1 === this.props.enter) : this.props.appear;\n        return this.isOn && ((\"when\" in this.props || \"spy\" in this.props) && !i || _globals.ssr && !_globals.fadeOutEnabled && !this.props.ssrFadeout && this.props.outEffect && !this.props.alwaysReveal && t.getTop(this.el) < window.pageYOffset + window.innerHeight) ? (this.isShown = !0, this.setState({\n          hasAppeared: !0,\n          collapse: this.props.collapse ? {\n            height: this.getDimensionValue()\n          } : this.state.collapse,\n          style: {\n            opacity: 1\n          }\n        }), void this.onReveal(this.props)) : _globals.ssr && (_globals.fadeOutEnabled || this.props.ssrFadeout) && this.props.outEffect && t.getTop(this.el) < window.pageYOffset + window.innerHeight ? (this.setState({\n          style: {\n            opacity: 0,\n            transition: \"opacity 1000ms 1000ms\"\n          }\n        }), void window.setTimeout(this.revealHandler, 2e3)) : void (this.isOn && (this.props.force ? this.animate(this.props) : this.reveal(this.props)));\n      }\n    }\n  }, {\n    key: \"cascade\",\n    value: function (e) {\n      var t = this,\n          i = void 0;\n      i = \"string\" == typeof e ? e.split(\"\").map(function (e, t) {\n        return _react2.default.createElement(\"span\", {\n          key: t,\n          style: {\n            display: \"inline-block\",\n            whiteSpace: \"pre\"\n          }\n        }, e);\n      }) : _react2.default.Children.toArray(e);\n      var s = this.props[this.isOn || !this.props.outEffect ? \"inEffect\" : \"outEffect\"],\n          o = s.duration,\n          n = s.reverse,\n          a = i.length,\n          r = 2 * o;\n      this.props.collapse && (r = parseInt(this.state.style.animationDuration, 10), o = r / 2);\n      var l = n ? a : 0;\n      return i = i.map(function (e) {\n        return \"object\" === (void 0 === e ? \"undefined\" : (0, _typeof3.default)(e)) && e ? _react2.default.cloneElement(e, {\n          style: (0, _extends4.default)({}, e.props.style, t.state.style, {\n            animationDuration: Math.round((0, _globals.cascade)(n ? l-- : l++, 0, a, o, r)) + \"ms\"\n          })\n        }) : e;\n      });\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function (e) {\n      if (\"when\" in e && (this.isOn = !!e.when), !this.isOn && e.onExited && \"exit\" in e && !1 === e.exit) return void e.onExited();\n      e.disabled || (e.collapse && !this.props.collapse && (this.setState({\n        style: {},\n        collapse: t.getInitialCollapseStyle(e)\n      }), this.isShown = !1), e.when === this.props.when && e.spy === this.props.spy || this.reveal(e), this.onRevealTimeout && !this.isOn && (this.onRevealTimeout = window.clearTimeout(this.onRevealTimeout)));\n    }\n  }, {\n    key: \"getChild\",\n    value: function () {\n      if (this.savedChild && !this.props.disabled) return this.savedChild;\n\n      if (\"object\" === (0, _typeof3.default)(this.props.children)) {\n        var e = _react2.default.Children.only(this.props.children);\n\n        return \"type\" in e && \"string\" == typeof e.type || \"ref\" !== this.props.refProp ? e : _react2.default.createElement(\"div\", null, e);\n      }\n\n      return _react2.default.createElement(\"div\", null, this.props.children);\n    }\n  }, {\n    key: \"render\",\n    value: function () {\n      var e = void 0;\n      e = this.state.hasAppeared ? !this.props.unmountOnExit || !this.state.hasExited || this.isOn : !this.props.mountOnEnter || this.isOn;\n      var t = this.getChild();\n      \"function\" == typeof t.ref && (this.childRef = t.ref);\n      var i = !1,\n          s = t.props,\n          o = s.style,\n          n = s.className,\n          a = s.children,\n          r = this.props.disabled ? n : (this.props.outEffect ? _globals.namespace : \"\") + (this.state.className ? \" \" + this.state.className : \"\") + (n ? \" \" + n : \"\") || void 0,\n          l = void 0;\n      \"function\" == typeof this.state.style.animationName && (this.state.style.animationName = this.state.style.animationName(!this.isOn, this.props)), this.props.cascade && !this.props.disabled && a && this.state.style.animationName ? (i = this.cascade(a), l = (0, _extends4.default)({}, o, {\n        opacity: 1\n      })) : l = this.props.disabled ? o : (0, _extends4.default)({}, o, this.state.style);\n\n      var p = (0, _extends4.default)({}, this.props.props, (0, _defineProperty3.default)({\n        className: r,\n        style: l\n      }, this.props.refProp, this.saveRef)),\n          h = _react2.default.cloneElement(t, p, e ? i || a : void 0);\n\n      return \"collapse\" in this.props ? this.props.collapseEl ? _react2.default.cloneElement(this.props.collapseEl, {\n        style: (0, _extends4.default)({}, this.props.collapseEl.style, this.props.disabled ? void 0 : this.state.collapse),\n        children: h\n      }) : _react2.default.createElement(\"div\", {\n        style: this.props.disabled ? void 0 : this.state.collapse,\n        children: h\n      }) : h;\n    }\n  }], [{\n    key: \"getTop\",\n    value: function (e) {\n      for (; void 0 === e.offsetTop;) e = e.parentNode;\n\n      for (var t = e.offsetTop; e.offsetParent; t += e.offsetTop) e = e.offsetParent;\n\n      return t;\n    }\n  }, {\n    key: \"getInitialCollapseStyle\",\n    value: function (e) {\n      return {\n        height: 0,\n        visibility: e.when ? void 0 : \"hidden\"\n      };\n    }\n  }]), t;\n}(_react2.default.Component);\n\nRevealBase.propTypes = propTypes, RevealBase.defaultProps = defaultProps, RevealBase.contextTypes = contextTypes, RevealBase.displayName = \"RevealBase\", exports.default = RevealBase, module.exports = exports.default;","map":null,"metadata":{},"sourceType":"script"}